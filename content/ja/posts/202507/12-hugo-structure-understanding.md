---
title: "Hugoブログを自分でカスタマイズするためのメモ"
archives: ["2025-07"]
tags: ["Hugo"]
description: "テーマとテンプレートについて理解して自分でテンプレート編集できるようになるまでの簡単な説明を書いた。"
---

このブログは Hugo という Go 製の静的サイト生成ツールを使って構築してるんですが、自分のブログを作るなら当然デザインも自分好みにカスタマイズしたくなるよね、と言うことで Hugo の基本的な構造について調べた内容をメモとして残しておきます。最初はちょっと複雑に見えるかもしれませんが、慣れてしまえば結構シンプルな構造になってます。

## テーマとテンプレートの基本的な関係

基本的にページのデザインやレイアウトはテーマが提供してくれます。テーマのテンプレートファイルは `themes/テーマ名/layouts/` に格納されているんですが、プロジェクトのルートディレクトリにも `layouts/` ディレクトリを作れるようになってます。

そして、ここが重要なポイントですがルートの `layouts/` にテーマと同じパスのファイルを置くと、テーマのファイルを上書きできる。つまり、テーマの機能を継承しつつ、気になる部分だけを自分好みにカスタマイズできる。

## URL とテンプレートの自動マッピング

Hugo は URL に応じて自動的に適切なテンプレートを選択する。例えば：

- TOP ページ（`/`）→ `layouts/index.html`
- 記事一覧ページ（`/posts/`）→ `layouts/_default/list.html`
- 記事詳細ページ（`/posts/記事名/`）→ `layouts/_default/single.html`

テンプレートを探すときは優先順位も決まっていて、まずルートの `layouts/` から探し、見つからなければテーマの `layouts/` を探す。この仕組みのおかげで、必要な部分だけをピンポイントでカスタマイズできる。

## タクソノミーによる記事の分類

Hugo にはタクソノミー（Taxonomy）という記事を分類・整理するための仕組みがある（要するにタグやカテゴリのこと）。設定ファイル（`hugo.toml`）で、どんな分類を使うかを定義できる：

```text
[taxonomies]
tag = 'tags'
category = 'categories'
```

左側が frontmatter で使う単数形のキー名で、右側が実際の URL やディレクトリ名になる複数形。ちょっとややこしいんですが、Hugo の仕様なので慣れるしかない。記事の frontmatter では、こんな感じで分類を指定する：

```text
tags: ["Hugo", "Web開発"]
categories: ["技術メモ"]
```

すると、Hugo が自動的に以下のようなページを生成する：

- `/tags/` - 全タグの一覧
- `/tags/hugo/` - "Hugo" タグが付いた記事一覧
- `/categories/` - 全カテゴリの一覧
- `/categories/技術メモ/` - "技術メモ" カテゴリの記事一覧

すでに述べたとおり URL によって使われるテンプレートも決まっていて、`/tags/` のようなタグ一覧ページでは `terms.html`、`/tags/hugo/` みたいな特定タグを持つ記事一覧ページは `list.html` が使われる。

## baseof テンプレートによる共通レイアウト

全てのページで共通して呼び出されるのが `layouts/_default/baseof.html` というテンプレートです。これは React でいう Layout コンポーネントみたいなもので、ヘッダーやフッターなど、サイト全体の共通レイアウトを一箇所で定義できる。

`baseof.html` の中を見ると、このような記述がある：

```text
<main>{{ block "main" . }}{{ end }}</main>
```

この `{{ block "main" . }}{{ end }}` が、各ページ固有のコンテンツを挿入するためのスロットでスロット名として main を使うと宣言している。そして、例えば TOP ページのテンプレート `index.html` を見ると：

```text
{{ define "main" }}
...TOPページの内容...
{{ end }}
```

こんな風に TOP ページのコンテンツに`main` という名前をつけている。これが `baseof.html` のスロットに TOP ページのコンテンツが挿入される仕組みとなる。

## partial で部品を再利用

テンプレートには、もう一つ便利な機能がある。`partial` という共通で使い回したいテンプレートを切り出すための仕組みである。

```text
{{ partial "head.html" . }}
```

こんな感じで、ヘッダーやフッターなどの共通部品を複数の箇所で使い回すことができる。コードの重複もなくなって、メンテナンス性も向上する。補足だがこれまで紹介したコードに出てきた `.` はページのコンテキストをテンプレートに渡すための記法。これがあることで、テンプレート内でページのタイトルや作成日、frontmatter の情報などにアクセスできるようになる。

## ショートコード（Shortcode）

Hugo にはショートコードという便利な機能がある。これはマークダウン記法だけでは表現しにくい複雑なコンテンツを簡単に埋め込むための便利な仕組みである。テンプレートがデザイナーが使うための部品であるのに対し、ショートコードは記事執筆者が使うための共通部品である。

例えば、YouTube 動画を埋め込みたい場合：

```text
{{</* youtube "動画ID" */>}}
```

図表を挿入したい場合：

```text
{{</* figure src="image.jpg" title="図のタイトル" */>}}
```

ショートコードは `layouts/shortcodes/` ディレクトリにテンプレートファイルを配置することで、独自のものを作成することもできる。例えば `layouts/shortcodes/note.html` を作れば：

```text
{{</* note */>}}
ここに注意書きの内容
{{</* /note */>}}
```

こんな感じで使えるようになる（Hugo には YouTube、Twitter、Instagram などの組み込みショートコードも用意されている）。
